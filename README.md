# fortran_mpi_memory_monitor

dump_mem_usagesをcallした箇所のメモリ使用量が測れる

準備:
mpi_memory_monitor.f90をコンパイルしてmpi_memory_monitor.oを生成しておく
makefileを使っているならmpi_memory_monitor.oがリンクされるように必要に応じて書き換える
dump_mem_usagesをcallしたいソースコードの頭の方でUSE mpi_memory_monitorするのを忘れずに

メモ:
dump_mem_usagesの結果はmem_usageフォルダ内に出力される。
dump_mem_usagesの引数は無くて良いが、第1引数に文字列・第2引数に装置番号を指定するとその装置に文字列を出力することが出来る。

Todo:
プロセスごとではなくノードごとにまとめてメモリ使用量を出力？


VASPの場合の手順:
mpi_memory_monitor.f90をmpi_memory_monitor.Fにリネームしてsrcフォルダ内に設置
src/.objectsの上の方にmpi_memory_monitor.o \を追記(最下行はGPUオプションがオンのときしか読まれないので不適)
main.F(でなくても良いが)にUSE mpi_mem_monitorとcall dump_mem_usages()を追記
